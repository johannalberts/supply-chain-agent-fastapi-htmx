{% extends "base.html" %}

{% block title %}Sign In - Supply Chain Intelligence{% endblock %}

{% block content %}
<div class="min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 px-4">
    <div class="max-w-md w-full">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-900 dark:text-white mb-2">
                Supply Chain Intelligence
            </h1>
            <p class="text-gray-600 dark:text-gray-400">
                AI-Powered Risk Analysis Platform
            </p>
        </div>
        
        <!-- Auth Card -->
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl p-8">
            <!-- Tabs -->
            <div class="flex mb-6 bg-gray-100 dark:bg-gray-700 rounded-lg p-1">
                <button 
                    onclick="switchTab('signin')"
                    id="signin-tab"
                    class="flex-1 py-2 px-4 rounded-md font-medium transition-colors tab-active"
                >
                    Sign In
                </button>
                <button 
                    onclick="switchTab('signup')"
                    id="signup-tab"
                    class="flex-1 py-2 px-4 rounded-md font-medium transition-colors tab-inactive"
                >
                    Sign Up
                </button>
            </div>
            
            <!-- Sign In Form -->
            <div id="signin-form" class="auth-form">
                <form hx-post="/auth/login" hx-swap="none" hx-on::after-request="handleAuthResponse(event)">
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">Username</label>
                        <input 
                            type="text" 
                            name="username" 
                            required
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                            placeholder="Enter username"
                        >
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">Password</label>
                        <input 
                            type="password" 
                            name="password" 
                            required
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                            placeholder="Enter password"
                        >
                    </div>
                    <div id="signin-error" class="hidden mb-4 p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm"></div>
                    <button 
                        type="submit"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg transition-colors"
                    >
                        Sign In
                    </button>
                </form>
            </div>
            
            <!-- Sign Up Form -->
            <div id="signup-form" class="auth-form hidden">
                <form hx-post="/auth/signup" hx-swap="none" hx-on::after-request="handleAuthResponse(event)">
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">Username</label>
                        <input 
                            type="text" 
                            name="username" 
                            required
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                            placeholder="Choose a username"
                        >
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2">Email</label>
                        <input 
                            type="email" 
                            name="email" 
                            required
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                            placeholder="your@email.com"
                        >
                    </div>
                    <div class="mb-6">
                        <label class="block text-sm font-medium mb-2">Password</label>
                        <input 
                            type="password" 
                            name="password" 
                            required
                            class="w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"
                            placeholder="Create a password"
                        >
                    </div>
                    <div id="signup-error" class="hidden mb-4 p-3 bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg text-red-700 dark:text-red-400 text-sm"></div>
                    <button 
                        type="submit"
                        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 rounded-lg transition-colors"
                    >
                        Create Account
                    </button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    function switchTab(tab) {
        const signinTab = document.getElementById('signin-tab');
        const signupTab = document.getElementById('signup-tab');
        const signinForm = document.getElementById('signin-form');
        const signupForm = document.getElementById('signup-form');
        
        if (tab === 'signin') {
            signinTab.classList.add('tab-active');
            signinTab.classList.remove('tab-inactive');
            signupTab.classList.add('tab-inactive');
            signupTab.classList.remove('tab-active');
            signinForm.classList.remove('hidden');
            signupForm.classList.add('hidden');
        } else {
            signupTab.classList.add('tab-active');
            signupTab.classList.remove('tab-inactive');
            signinTab.classList.add('tab-inactive');
            signinTab.classList.remove('tab-active');
            signupForm.classList.remove('hidden');
            signinForm.classList.add('hidden');
        }
    }
    
    function handleAuthResponse(event) {
        const xhr = event.detail.xhr;
        const response = JSON.parse(xhr.responseText);
        
        if (xhr.status === 200) {
            window.location.href = '/dashboard';
        } else {
            const errorDiv = event.detail.target.querySelector('[id$="-error"]');
            errorDiv.textContent = response.detail || 'An error occurred';
            errorDiv.classList.remove('hidden');
        }
    }
</script>

<style>
    .tab-active {
        background-color: white;
        color: #1f2937;
    }
    .dark .tab-active {
        background-color: #374151;
        color: white;
    }
    .tab-inactive {
        color: #6b7280;
    }
    .tab-inactive:hover {
        color: #374151;
    }
    .dark .tab-inactive:hover {
        color: #d1d5db;
    }
</style>
{% endblock %}
